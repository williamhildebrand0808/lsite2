<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Personen-Datenbank</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    font-family: Arial, sans-serif;
    background:#111;
    color:#0ff;
    padding:20px;
}
h1 { text-align:center; color:orange; }

input, button {
    width:100%;
    max-width:400px;
    margin-bottom:10px;
    padding:7px;
    background:black;
    border:1px solid cyan;
    color:cyan;
}

button {
    cursor:pointer;
}
button:hover {
    background:cyan;
    color:black;
}

.personCard {
    border:1px solid cyan;
    padding:10px;
    margin-bottom:10px;
}
.personCard h3 {
    color:orange;
    margin:0 0 5px;
}

.actions button {
    width:auto;
    margin-right:5px;
}
</style>
</head>

<body>

<h1>Personen-Datenbank</h1>

<h2>Person hinzufügen / bearbeiten</h2>
<input id="name" placeholder="Name">
<input id="age" type="number" placeholder="Alter">
<input id="city" placeholder="Stadt">
<input id="country" placeholder="Land">
<input id="info" placeholder="Instagram / Info">
<button id="saveBtn">Speichern</button>

<hr>

<input id="search" placeholder="Suche..." style="max-width:300px">

<div id="list"></div>

<script>
/* =======================
   DATEN & HILFSFUNKTIONEN
======================= */
let people = JSON.parse(localStorage.getItem("people")) || [];
let editIndex = null;

const $ = id => document.getElementById(id);

function saveStorage() {
    localStorage.setItem("people", JSON.stringify(people));
}

function clearForm() {
    ["name","age","city","country","info"].forEach(id => $(id).value = "");
    editIndex = null;
}

/* =======================
   RENDER & FILTER
======================= */
function render() {
    const q = $("search").value.toLowerCase();
    $("list").innerHTML = "";

    people
    .filter(p =>
        p.name.toLowerCase().includes(q) ||
        p.city.toLowerCase().includes(q) ||
        p.country.toLowerCase().includes(q) ||
        p.info.toLowerCase().includes(q)
    )
    .forEach((p,i) => {
        const div = document.createElement("div");
        div.className = "personCard";
        div.innerHTML = `
            <h3>${p.name}</h3>
            <p><b>Alter:</b> ${p.age ?? "-"}</p>
            <p><b>Stadt:</b> ${p.city || "-"}</p>
            <p><b>Land:</b> ${p.country || "-"}</p>
            <p><b>Info:</b> ${p.info || "-"}</p>
            <div class="actions">
                <button onclick="edit(${i})">Bearbeiten</button>
                <button onclick="removePerson(${i})">Löschen</button>
            </div>
        `;
        $("list").appendChild(div);
    });
}

/* =======================
   CRUD
======================= */
$("saveBtn").onclick = () => {
    const person = {
        name: $("name").value.trim(),
        age: $("age").value ? Number($("age").value) : null,
        city: $("city").value.trim(),
        country: $("country").value.trim(),
        info: $("info").value.trim()
    };

    if(!person.name) return alert("Name fehlt!");

    editIndex === null ? people.push(person) : people[editIndex] = person;

    saveStorage();
    clearForm();
    render();
};

function edit(i) {
    const p = people[i];
    $("name").value = p.name;
    $("age").value = p.age ?? "";
    $("city").value = p.city;
    $("country").value = p.country;
    $("info").value = p.info;
    editIndex = i;
}

function removePerson(i) {
    if(confirm("Person wirklich löschen?")) {
        people.splice(i,1);
        saveStorage();
        render();
    }
}

/* =======================
   EVENTS
======================= */
$("search").oninput = render;

/* =======================
   INIT
======================= */
render();
</script>

</body>
</html>
