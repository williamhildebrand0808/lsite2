<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Personen-Globus HUD</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { margin:0; overflow:hidden; font-family:'Courier New',monospace; background:black; color:white; }
#globeViz { width:100vw; height:100vh; display:block; }
.popup {
  position:absolute;
  top:10px; right:10px;
  background: rgba(0,0,0,0.95);
  border:1px solid #0f0;
  padding:15px;
  width:90vw;
  max-width:320px;
  font-size:14px;
  line-height:1.4;
  box-shadow:0 0 20px rgba(0,255,0,0.3);
  display:none;
}
.popup input, .popup textarea {
  width:100%;
  margin-bottom:8px;
  border-radius:3px;
  border:1px solid #0f0;
  padding:5px;
  background:black;
  color:#0f0;
}
.popup button {
  padding:5px 10px;
  border:none;
  border-radius:3px;
  background:orange;
  color:black;
  cursor:pointer;
  font-weight:bold;
}
.popup h3 { margin-top:0; color:orange; text-align:center; letter-spacing:1px; }
</style>
</head>
<body>

<div id="globeViz"></div>

<div class="popup" id="popup">
<h3>SUBJECT PROFILE</h3>
<input id="name" placeholder="Name" />
<input id="ort" placeholder="Ort" />
<textarea id="info" placeholder="Infos"></textarea>
<button onclick="savePerson()">Speichern</button>
</div>

<!-- Bibliotheken über CDN -->
<script src="https://cdn.jsdelivr.net/npm/three@0.153.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/globe.gl@4.6.2/dist/globe.gl.min.js"></script>

<script>
// Personen-Daten laden
let people = JSON.parse(localStorage.getItem('people')) || [];

const globe = Globe()
  .globeImageUrl('https://unpkg.com/three-globe/example/img/earth-blue-marble.jpg')
  .backgroundImageUrl('https://images.unsplash.com/photo-1541267251-68a7b7d18e8c?auto=format&fit=crop&w=1920&q=80')
  .pointsData(people)
  .pointLat(d=>d.lat)
  .pointLng(d=>d.lng)
  .pointColor(()=> 'orange')
  .pointRadius(0.6)
  .pointAltitude(0.02)
  .pointsTransitionDuration(0)
  .pointLabel(d=>`<b>${d.name}</b><br/>Ort: ${d.place}<br/>${d.info}`)
  (document.getElementById('globeViz'));

// Klick → Popup öffnen
globe.onGlobeClick(({lat,lng})=>{
  currentLat=lat;
  currentLng=lng;
  document.getElementById("popup").style.display="block";
});

let currentLat,currentLng;

// Steckbrief speichern
function savePerson() {
  const name=document.getElementById("name").value;
  const place=document.getElementById("ort").value;
  const info=document.getElementById("info").value;
  const newPerson={lat:currentLat,lng:currentLng,name,place,info};
  people.push(newPerson);
  globe.pointsData(people);
  localStorage.setItem('people',JSON.stringify(people));
  document.getElementById("popup").style.display="none";
  document.getElementById("name").value="";
  document.getElementById("ort").value="";
  document.getElementById("info").value="";
}
</script>

</body>
</html>
